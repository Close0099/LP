<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acesso Admin</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="auth-body">
    <div class="auth-container">
        <div class="auth-card">
            <div class="auth-header">
                <div class="auth-icon">üîí</div>
                <h1>Acesso ao Painel Admin</h1>
                <p>Introduza o c√≥digo de acesso para continuar.</p>
            </div>
            <div class="auth-form">
                <label for="access-code">C√≥digo</label>
                <input type="password" id="access-code" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autofocus>
                <button id="access-button">Entrar</button>
                <div id="access-error" class="auth-error hidden">C√≥digo incorreto. Tente novamente.</div>
            </div>
            <div class="auth-footer">
                <a href="index.html">‚Üê Voltar</a>
            </div>
        </div>
    </div>

    <script src="js/firebase-config.js"></script>
    <script>
        // Config
        const ACCESS_CODE = typeof ADMIN_ACCESS_CODE !== 'undefined' ? ADMIN_ACCESS_CODE : '1234';
        const MAX_ATTEMPTS = 5;
        const LOCK_MS = 30_000;

        const input = document.getElementById('access-code');
        const button = document.getElementById('access-button');
        const errorEl = document.getElementById('access-error');

        let attempts = 0;
        let lockedUntil = 0;

        function setError(msg) {
            errorEl.textContent = msg;
            errorEl.classList.remove('hidden');
        }

        function clearError() {
            errorEl.classList.add('hidden');
        }

        function tryAccess() {
            const now = Date.now();
            if (now < lockedUntil) {
                const secs = Math.ceil((lockedUntil - now) / 1000);
                setError(`Muitas tentativas. Aguarde ${secs}s.`);
                return;
            }

            clearError();

            if (input.value === ACCESS_CODE) {
                // feedback r√°pido
                setError('C√≥digo correto! Redirecionando...');
                errorEl.style.background = 'rgba(34,197,94,0.15)';
                errorEl.style.color = '#bbf7d0';
                errorEl.style.borderColor = 'rgba(34,197,94,0.3)';
                setTimeout(() => {
                    window.location.href = 'admin_2026.html';
                }, 400);
            } else {
                attempts += 1;
                if (attempts >= MAX_ATTEMPTS) {
                    lockedUntil = now + LOCK_MS;
                    setError('Muitas tentativas. Aguarde 30s.');
                } else {
                    setError('C√≥digo incorreto. Tente novamente.');
                }
                input.focus();
                input.select();
            }
        }

        button.addEventListener('click', tryAccess);
        input.addEventListener('keyup', (e) => {
            if (e.key === 'Enter') tryAccess();
        });

        // Bot√£o mostrar/ocultar
        const toggle = document.createElement('button');
        toggle.type = 'button';
        toggle.textContent = 'Mostrar';
        toggle.className = 'auth-toggle';
        toggle.addEventListener('click', () => {
            if (input.type === 'password') {
                input.type = 'text';
                toggle.textContent = 'Ocultar';
            } else {
                input.type = 'password';
                toggle.textContent = 'Mostrar';
            }
            input.focus();
        });
        input.insertAdjacentElement('afterend', toggle);
    </script>
</body>
</html>
